<%= javascript_include_tag :defaults %>

<% if condition.new_record?
     condition_div = 'conditionNew' 
     html_options = {} -%>
<div id="conditionNew">
<% else
     condition_div = "condition#{condition.id}"
     html_options = {:method => 'put'}
   end %>
<% remote_form_for(:condition, condition, :url => patient_data_instance_condition_path(patient_data, condition), :html => html_options,
                   :update => condition_div, :name => "conditions_form") do |f| -%>
<table>
  <tr class="<%= cycle("darkzebra", "lightzebra")%>">
    <td class="lighttext">Start Event</td>
    <td>
      <%= f.calendar_date_select :start_event %>
    </td>
  </tr>
  <tr class="<%= cycle("darkzebra", "lightzebra")%>">
    <td class="lighttext">End Event</td>
    <td>
      <%= f.calendar_date_select :end_event %>
    </td>
  </tr>
  <tr class="<%= cycle("darkzebra", "lightzebra")%>">
    <td class="lighttext">Problem Type</td>
    <td>
      <%= f.select :problem_type_id, @problem_types.collect{|problem| [problem.name, problem.id]}, {:include_blank => true} %>
    </td>
  </tr>
  <tr class="<%= cycle("darkzebra", "lightzebra")%>">
    <td class="lighttext">Free Text Problem Name</td>
    <td>
	  <%= text_field_with_auto_complete :snowmed_problem, :name, {:value => condition.free_text_name}, :method => :get %>
	</td>
  </tr>
  <tr class="<%= cycle("darkzebra", "lightzebra")%>">
    <td><input id="condition_name" name="condition[free_text_name]" type="hidden" value="<%=condition.free_text_name%>"></td>
	<td><%= f.submit "Save", :onclick => "update_value('snowmed_problem_name', 'condition_name')" %></td>
  </tr>
</table>
<% end %>

